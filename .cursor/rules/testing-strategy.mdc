---
description: Focused testing strategy with separation between business logic and CLI tests
globs: ["tests/**/*.py", "**/*test*.py", "conftest.py"]
alwaysApply: false
---

# Testing Strategy Standards

## Core Principle

Maximize value while minimizing redundancy. Test the appropriate layer - don't duplicate business logic tests in CLI tests.

## Testing Layers

### 1. Business Logic Tests

**Comprehensive coverage** of core functionality:

- Data processing classes (`ParquetLoader`, `PlaidExtractor`)
- Configuration classes and dataclasses
- Database operations and transformations
- Error handling and edge cases
- Integration tests (`@pytest.mark.integration`)

### 2. CLI Interface Tests

**Minimal, focused** on CLI concerns only:

- Argument parsing and validation
- Exit codes
- Error message handling
- Logging setup
- Command building/subprocess execution

**DON'T test** in CLI layer:

- Business logic (already tested separately)
- Data processing operations
- Complex error scenarios

## Mocking Strategy

**Business Logic**: Mock external dependencies (APIs, databases), use real objects for internal logic
**CLI Tests**: Mock business logic classes (already tested)

## CLI Testing Priority

**High Priority** (test these):

- Complex argument parsing with validation/security
- Subprocess execution
- Security-sensitive operations

**Low Priority** (may skip):

- Simple wrappers around tested business logic
- Static information display

## Coverage Goals

- Business Logic: 90%+ coverage
- CLI Commands: CLI-specific paths only
- Integration: Critical workflows end-to-end
