---
description: Core Python development standards and conventions for MoneyBin project
alwaysApply: true
---

# Python Core Standards

## Package Management

**CRITICAL: Use `uv` for all Python package management:**

- `uv add package-name` - Add dependency
- `uv run command` - Run commands in project environment
- `uv sync` - Install/update dependencies
- **NEVER use**: `pip install`, `uv pip install`, `pip install -e .`, `python -m moneybin.cli.main`

## Code Style & Formatting

- **Ruff**: All code must be formatted/linted with [Ruff](https://docs.astral.sh/ruff/) (line length 88)
- Run `ruff format .` and `ruff check .` before committing
- Use `ruff check --fix` to organize imports
- Prefer absolute imports, use relative only within packages
- **ALWAYS include reason** for `# noqa:` or `# type: ignore` comments
- **Triple-quoted strings for inline SQL**: Always use `"""..."""` for SQL embedded in Python

## Type Hints & Annotations

- **All** function parameters and return values must have type hints
- Use **Pyright** for type checking (not mypy)
- **ALWAYS run pyright** on modified files before completion
- Use modern Python types: `list[str]`, `dict[str, Any]`, `str | None` (not `List`, `Dict`, `Optional`)
- Type aliases for complex types: `TransactionData = dict[str, str | float | datetime]`

### Pydantic Models

- Use [Pydantic](https://docs.pydantic.dev/) for API responses and data structures
- Include field descriptions, constraints, and validators

## Error Handling & Logging

- Catch **specific exceptions**, not generic `Exception`
- Use structured logging with appropriate levels (DEBUG, INFO, WARNING, ERROR, CRITICAL)
- Include context in error messages and log statements
- Always use `logger = logging.getLogger(__name__)`

## Documentation

- **Google-style docstrings** for all public functions/classes
- Include Args, Returns, Raises sections
- Link to authoritative documentation when suggesting framework methods
- Document data sources, extraction methods, and transformation processes

## Code Organization

- **Prefer editing** existing files over creating new ones
- Use clear, descriptive naming (see `naming-conventions.mdc`)
- Organize code into logical modules and functions
- Modern Python idioms: `datetime | None` not `Optional[datetime]`

## Data Processing

**Always prefer: DuckDB > Polars > Pandas**

See `data-processing.mdc` for complete guidelines.

## Development Process

1. Verify approach before implementation
2. Minimize edits - targeted changes over rewrites
3. Test incrementally
4. Run pyright on modified files
5. Format/lint with Ruff before committing
